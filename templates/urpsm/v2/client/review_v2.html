<!DOCTYPE html>
{% load static from staticfiles %}
{% load i18n reviewing_tags %}
<html>
<head>
    <title>{% trans 'client status'|capfirst %} | Unlock Repair Phone Shop Manager</title>

	<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">

    <link href="{% static 'v2/css/bootstrap.min.css' %}" rel="stylesheet">
    <link href="{% static 'v2/css/font-awesome.css' %}" rel="stylesheet">
    <link href="{% static 'v2/css/animate.min.css' %}" rel="stylesheet">
    <link href="{% static 'v2/css/bootstrap-checkbox.css' %}" rel="stylesheet" >
    <link href="{% static 'v2/css/minoral.css' %}" rel="stylesheet">
    <link href="{% static 'v2/css/signup.css' %}" rel="stylesheet">
    <link rel="shortcut icon" href="{% static 'v2/images/logo-big.png' %}">

    <!-- start rtl vesion-->
    <link href='https://fonts.googleapis.com/earlyaccess/droidarabicnaskh.css' rel='stylesheet' type='text/css'/>
    <link href="{% static 'v2/css/rtl.css' %}" rel="stylesheet">
    <!-- end rtl vesion-->

  </head>
  <body class="brownish-scheme">
    <div id="wrap">
      <div class="row">
		  <img src="{% static 'v2/images/logo-big.png' %}" class="logo opa-200" style="position:fixed;z-index:100;opacity:0.5;">
        <div id="content" class="col-md-12 full-page login">
          <div class="welcome">

			<div class="text-center">
				<img class="" src="{{client.model.picture.url}}" style="height:200px;" alt="{{client.ref}}">
			</div>
			  <br><br>
			  <table class="align-center" style="width: 100%;">
  <tbody><tr>
    <td class="label-warning"><span>{% trans 'reference'|capfirst %}</span></td>
    <td class="label-primary"><span>{{client.ref}}</span></td>
  </tr>
  <tr>
    <td class="label-warning"><span>{% trans 'status'|capfirst %} </span></td>
    <td class="label-primary"><span>{{client.status|status_name}}</span></td>
  </tr> </tbody></table>
			<hr class="seper">
			<p  class="error"></p>

			<span class="">
		    	<i class="fa fa-mobile {% ifequal client.status 'r' %} text-green {% else %} text-red {%endifequal%}"></i>
			</span>

			{% if client.status == 'r' or delivery_time_exceeded %} 
				<div class="rate-box">
				    <div>
				        <span class="icon-ratings unrated-star" id="1"></span>
				        <span class="icon-ratings unrated-star" id="2"></span>
				        <span class="icon-ratings unrated-star" id="3"></span>
				        <span class="icon-ratings unrated-star" id="4"></span>
				        <span class="icon-ratings unrated-star" id="5"></span>

						<br><br>
						<span id="txt1" style="display:none;padding:6px;background: #ca9c6e;border-radius: 3px;" class="dtxt">{% trans 'Terrible'|capfirst %}</span>
						<span id="txt2" style="display:none;padding:6px;background: #ca9c6e;border-radius: 3px;" class="dtxt">{% trans 'Below average'|capfirst %}</span>
						<span id="txt3" style="display:none;padding:6px;background: #ca9c6e;border-radius: 3px;" class="dtxt">{% trans 'OK'|capfirst %}</span>
						<span id="txt4" style="display:none;padding:6px;background: #ca9c6e;border-radius: 3px;" class="dtxt">{% trans 'Good'|capfirst %}</span>
						<span id="txt5" style="display:none;padding:6px;background: #ca9c6e;border-radius: 3px;" class="dtxt">{% trans 'Excellent'|capfirst %}</span>

				   </div>
				</div>


	            <form id="form-signin form-review" class="form-signin marg-top-10" action="" method="post">
	                <textarea id="review" class="form-control" placeholder="{% trans 'help other customer to make the right choice'|capfirst %}" rows=5></textarea>
	              	<section class="new-acc">
	               	 <button id="submit" class="btn btn-greensea rev-btn">{% trans 'submit review'|capfirst %}</button>
	              	</section>
	            </form>  
 			{%endif%}
				<hr class="seper">
				<div class="foot-infos align-left-fullwidth">
					<div class="foot-shop inline-48-p">
						<span>{{client.shop.name|capfirst}}</span>
		  				<div class="star-ratings-sprite"><span style="width:{{client.shop.average_rating|multiply:20}}%" class="star-ratings-sprite-rating"></span></div>
					</div>
					<div class="foot-call mail-phone-sec" style="margin-top:30px;">
				    	<span>
				    		<i class="fa fa-phone"></i> &nbsp;<a href="tel:{{client.shop.shop_phone}}">{{client.shop.shop_phone}}</a><br>
				    		<i class="fa fa-envelope"></i> &nbsp;<a href="mailto:{{client.shop.shop_email}}">{{client.shop.shop_email}}</a>
				    	</span>
					</div>
				</div>
			{%comment%}
				<span class="abs-left-0">
					<span>{{client.shop.name|capfirst}}</span>
		  				<div class="star-ratings-sprite">
		  				<span style="width:{{client.shop.average_rating|multiply:20}}%" class="star-ratings-sprite-rating"></span>
		  				</div>
					
				    <span class="pull-right numsz"><i class="fa fa-phone"></i> &nbsp;<a href="tel:{{client.shop.shop_phone}}">{{client.shop.shop_phone}}</a><br><i class="fa fa-envelope"></i> &nbsp;<a href="mailto:{{client.shop.shop_email}}">{{client.shop.shop_email}}</a> </span>
				</span>
				<p class="align-left-flex">
					<span class="width-45-p">
						{{client.shop.name|capfirst}}
	                     ({{client.shop.reviews_count}})
        			</span>
					<div class="star-ratings-sprite"><span style="width:{{client.shop.average_rating|multiply:20}}%" class="star-ratings-sprite-rating"></span></div>

				    <span class="pull-right numsz"><i class="fa fa-phone"></i> &nbsp;<a href="tel:{{client.shop.shop_phone}}">{{client.shop.shop_phone}}</a><br><i class="fa fa-envelope"></i> &nbsp;<a href="mailto:{{client.shop.shop_email}}">{{client.shop.shop_email}}</a> </span>
				</p>
			{%endcomment%}          
        </div>
    </div>
    </div>
    <script src="{% static 'v2/js/jquery.js' %}"></script>
    <script src="{% static 'v2/js/bootstrap.min.js' %}"></script>
    <script src="{% static 'v2/js/plugins/jquery.nicescroll.min.js' %}"></script>
    <script src="{% static 'v2/js/plugins/jquery.blockUI.js' %}"></script>
    <script src="{% static 'v2/js/minoral.min.js' %}"></script>
    <script src="{% static 'v2/js/jquery.easing.min.js' %}" type="text/javascript"></script>

    <script>
    $(function(){
      
      $('.welcome').addClass('animated bounceIn');

    })
      
    </script>
    
    


<script>
	
$(document).ready(function(e) {
	$('.error').hide();
	$('.icon-ratings').on({
		mouseover: function(){
			var element = '.icon-ratings';
			$(this).prevAll().andSelf().addClass('rated-star');
			$(this).prevAll().andSelf().removeClass('unrated-star');
			if(element == '.icon-ratings') {
				$(this).prevAll().find('p').hide();
				$(this).nextAll().find('p').hide();
				$('.click-star-txt').hide(); 
				$(this).find('p').show();
				var te = $(this).attr('id');
				$('.dtxt').hide();
				$('#txt'+te).show();

			}
		},
		mouseleave: function(){
				$(this).prevAll().andSelf().addClass('unrated-star');
				$(this).prevAll().andSelf().removeClass('rated-star');
				$(this).prevAll().find('p').hide();
				$(this).nextAll().find('p').hide(); 
				$(this).find('p').show();
				$('.rate-box span').each(function() {
					if($(this).hasClass('unrated-star')) {
	  					$('.click-star-txt').show();
	  					$('.icon-ratings').find('p').hide();
					}
				});
				
		},
		click: function(e){
			$(this).off('mouseover mouseleave');
			$(this).siblings().off('mouseover mouseleave');
			$(this).nextAll().removeClass('rated-star');
			$(this).nextAll().addClass('unrated-star');
			$(this).prevAll().andSelf().addClass('rated-star');
			$(this).prevAll().andSelf().removeClass('unrated-star');
			$(this).prevAll().find('p').hide();
			$(this).nextAll().find('p').hide();
			$(this).find('p').show();
			var te = $(this).attr('id');
			$('.dtxt').hide();
			$('#txt'+te).show();
			window['rating'] = parseInt(e.target.id);
		}
	});
	
	$('#submit').on('click', function(e){
		e.preventDefault();
		var data = {
			'shop':'{{client.shop.pk}}',
			'csrfmiddlewaretoken':'{{csrf_token}}',
			'client':'{{client.pk}}',
			'rating':window['rating'],
			'content':$('#review').val(),
		};
		$.ajax({
			url: "{% url 'review-shop' %}",
			data: data,
			type: 'POST',
			success: function(e){
				if (e.status){
					$('.error').hide();
					window.location = "{% url 'thank-client' %}";
				}else{
					$('.error').text(e.message);
					$('.error').show();
				}
			}
		});
	});
});	

</script>


</body>
</html>