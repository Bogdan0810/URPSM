{% extends "urpsm/v2/base_manager_v2.html" %}
{% load i18n staticfiles%}
{% block title %} Add new client {% endblock %}
{% block heading %} Client {% endblock %}
{% block subheading %} Adding new client{% endblock %}
{% block breadcrumb %}
<li>
    <a href="{% url 'clients' %}" title="clients">{% trans 'clients'|capfirst %}</a>
</li>
<li class="active">{% trans 'add'|capfirst %}</li>
{% endblock %}

{% block content %}

<section class="content">
<div class="box">
    <div class="box-header">
        <h3 class="box-title">{% trans 'add client'|capfirst %}</h3>
    </div>
    <form action="" method="post" accept-charset="utf-8" enctype="multipart/form-data">
        {% csrf_token %}
        <div class="box-body">
            <div class="row">
                <div class="col-md-12">

                    <div class="col-md-4">
                    <div class="form-group">
                        <label for="{{form.ref.label}}">{% trans form.ref.label|capfirst %}</label>

                        {{ form.ref }}
                                {% if form.ref.errors %}
                                    {{ form.ref.errors }}
                                {% endif %}
                    </div>
                    </div>
                    <div class="col-md-4">
                    <div class="form-group">
                    <label for="{{form.brand.label}}">{% trans form.brand.label|capfirst %}</label>
                        {{ form.brand }}
                                {% if form.brand.errors %}
                                    {{ form.brand.errors }}
                                {% endif %}
                    </div>
                    </div>
                    <div class="col-md-4">
                    <div class="form-group">
                        <label for="{{form.model.label}}">{% trans form.model.label|capfirst %}</label>
                        {{ form.model }}
                                {% if form.model.errors %}
                                    {{ form.model.errors }}
                                {% endif %}
                    </div>
                    </div>
                </div>
            
            
            <div class="col-md-12">
                <div class="col-md-3">
                    <div class="form-group">
                    <label for="{{form.serial.label}}">{% trans form.serial.label|capfirst %}</label>
                        {{ form.serial }}
                                {% if form.serial.errors %}
                                    {{ form.serial.errors }}
                                {% endif %}
                    </div>
                </div>

                <div class="col-md-3">
                <div class="form-group">
                    <label for="{{form.imei.label}}">{% trans form.imei.label|capfirst %}</label>
                        {{ form.imei }}
                                {% if form.imei.errors %}
                                    {{ form.imei.errors }}
                                {% endif %}
                    </div>
                </div>

                <div class="col-md-3">
                    <div class="form-group">
                    <label for="{{form.phone_number.label}}">{% trans form.phone_number.label|capfirst %}</label>
                        {{ form.phone_number }}
                                {% if form.phone_number.errors %}
                                    {{ form.phone_number.errors }}
                                {% endif %}
                    </div>
                </div>

                <div class="col-md-3">
                    <div class="form-group">
                        <label for="{{form.email.label}}">{% trans form.email.label|capfirst %}</label>
                        {{ form.email }}
                                {% if form.email.errors %}
                                    {{ form.email.errors }}
                                {% endif %}
                    </div>
                </div>

                <div class="col-md-3">
                    <div class="form-group">
                        <label for="{{form.amount.label}}">{% trans form.amount.label|capfirst %}</label>
                        <div class="input-group"><span class="input-group-addon">$</span>{{ form.amount }}</div>
                                {% if form.amount.errors %}
                                    {{ form.amount.errors }}
                                {% endif %}
                    </div>
                </div>
                <div class="col-md-3">
                    <div class="form-group">
                    <label for="{{form.delivery_time.label}}">{% trans form.delivery_time.label|capfirst %}</label>
                        {{ form.delivery_time }}
                                {% if form.delivery_time.errors %}
                                    {{ form.delivery_time.errors }}
                                {% endif %}
                    </div>
                </div>

                <div class="col-md-3">
                    <div class="form-group">
                    <label for="{{form.status.label}}">{% trans form.status.label|capfirst %}</label>
                        {{ form.status }}
                                {% if form.status.errors %}
                                    {{ form.status.errors }}
                                {% endif %}
                    </div>
                </div>
                <div class="col-md-3">
                    <div class="form-group">
                        <label for="{{form.todo.label}}">{% trans form.todo.label|capfirst %}</label>
                        {{ form.todo }}
                                {% if form.todo.errors %}
                                    {{ form.todo.errors }}
                                {% endif %}
                    </div>
                </div>
            </div>
            <div class="col-md-12">
                <div class="col-md-6">
                    <div class="form-group">
                    <label for="{{form.status_description.label}}">{% trans form.status_description.label|capfirst %}</label>
                        {{ form.status_description }}
                                {% if form.status_description.errors %}
                                    {{ form.status_description.errors }}
                                {% endif %}
                    </div>
                </div>
                    

                <div class="col-md-6">
                    <div class="form-group">
                    <label for="{{form.todo_description.label}}">{% trans form.todo_description.label|capfirst %}</label>
                        {{ form.todo_description }}
                                {% if form.todo_description.errors %}
                                    {{ form.todo_description.errors }}
                                {% endif %}
                    </div>
                </div>
            </div>
            <div class="col-md-12">
                <div class="col-xs-8">
                    <div class="form-group">
                        <div class="checkbox icheck">
                            <label>{{ form.paid }} &nbsp; {% trans 'paid'|capfirst %}</label>
                        </div>
                    </div>
                </div>
            </div>

        <!-- </div> -->
        
      <div class="col-md-12">
          <div class="col-md-6">

            <div id="accordion" class="box-group">
                <div class="panel box">
                    <div class="box-header">
                        <h4 class="box-title">
                            <a data-toggle="collapse" href="#addons" class="collapsed"><i class="fa fa-th"></i> {% trans 'addons'|capfirst %}</a>
                        </h4>
                    </div>
                          <div id="addons" class="panel-collapse collapse in">
                            <div class="box-body">
                                {{ addonformset.management_form }}
                                {% for addon_form in addonformset %}
                                    <div class="row">
                                        <div class="item addons_phone" id="id-{{ forloop.counter0 }}">

                                            <div class="col-md-12">
                                            <div class="col-md-6">
                                                <div class="form-group">
                                                    {{ addon_form.type }}
                                                        {% if addon_form.type.errors %}
                                                            {{ addon_form.type.errors }}
                                                        {% endif %}
                                                </div>
                                            </div>
                                            <div class="col-md-6">
                                                <div class="form-group">
                                                    {{ addon_form.name }}
                                                            {% if addon_form.name.errors %}
                                                                {{ addon_form.name.errors }}
                                                            {% endif %}
                                                </div>
                                            </div>  
                                            </div>                                      
                                            <div class="col-md-12">
                                            <div class="col-md-6">
                                                <div class="form-group">

                                                    <div class="input-group"> 
                                                    <span class="input-group-addon">$</span>
                                                    {{ addon_form.price }}
                                                    </div>
                                                    <p class="help-block">{{ addon_form.price.help_text }}</p>
                                                            {% if addon_form.price.errors %}
                                                                {{ addon_form.price.errors }}
                                                            {% endif %}
                                                </div>
                                            </div>
                                            <div class="col-md-6">
                                                <div class="form-group">

                                                    <div class="input-group"> 
                                                    <span class="input-group-addon">$</span>
                                                    {{ addon_form.original_price }}
                                                    </div>
                                                    <p class="help-block">{{ addon_form.original_price.help_text }}</p>
                                                            {% if addon_form.original_price.errors %}
                                                                {{ addon_form.original_price.errors }}
                                                            {% endif %}
                                                </div>
                                            </div> 
                                            </div>                                       
                                            <!--div class="col-lg-3">
                                                {% if addonformset.can_delete %}
                                                    <div class="form-group">
                                                        {{ addon_form.DELETE }} &nbsp;Delete
                                                                {% if addon_form.DELETE.errors %}
                                                                    {{ addon_form.DELETE.errors }}
                                                                {% endif %}
                                                    </div>
                                                {% endif %}
                                                p style=""><a class="delete" href="#"><i class="fa fa-close text-red"></i>&nbsp;Delete</a></p>
                                            </div-->
                                        </div>
                                    </div>
                                {% endfor %}
                                <p><a id="add-addon" href="#"><i class="fa fa-plus text-green"></i>&nbsp;{% trans 'add another item'|capfirst %}</a></p>
                            </div>
                          </div>
                </div>
                </div>
                </div>

                <div class="col-md-6">
                <div class="panel box">
                    <div class="box-header">
                        <h4 class="box-title">
                            <a data-toggle="collapse" href="#images" class="collapsed"><i class="fa fa-image"></i>&nbsp;{% trans 'images'|capfirst %}</a>
                        </h4>
                    </div>
                    <div id="images" class="panel-collapse collapse in">
                            <div class="box-body">
                                {{ imageformset.management_form }}
                                {% for image_form in imageformset %}
                    <div class="row">
                        <div class="item images_phone" id="id-{{ forloop.counter0 }}">
                        <div class="col-lg-8">
                        <div class="form-group">
                        {{ image_form.image }}
                        {% if image_form.image.errors %}
                        {{ image_form.image.errors }}
                        {% endif %}
                        </div>
                    </div>
                    <!--div class="col-lg-4">{% if imageformset.can_delete %}
                            <div class="form-group">
                                {{ image_form.DELETE }} &nbsp;Delete
                                        {% if image_form.DELETE.errors %}
                                            {{ image_form.DELETE.errors }}
                                        {% endif %}
                            </div>
                        {% endif %}</div-->
                               <!--p style=""><a class="delete" href="#"><i class="fa fa-close text-red"></i>&nbsp;Delete</a></p-->
                           </div>
                    </div>
                        {% endfor %}
                        <p><a id="add-image" href="#"><i class="fa fa-plus text-green"></i>&nbsp;{% trans 'add another item'|capfirst %}</a></p>
                    </div>
                  </div>
                </div>
                </div>
            </div>
            </div>
        <div class="box-footer">
            <input class="btn btn-primary" type="submit" value="{% trans 'Save' %}" />
        </div>
        </div>
        </div>
    </form>
</div>
</section>
{% endblock %}




{% block extrajs %}
<script src="{% static "suit-redactor/redactor/redactor.min.js" %}" type="text/javascript"></script>
<script src="{% static "js/plugins/iCheck/icheck.min.js" %}" type="text/javascript"></script>
<script src="{% static "js/plugins/daterangepicker/moment.min.js" %}" type="text/javascript"></script>
<script src="{% static "django_select2/js/select2.min.js" %}" type="text/javascript"></script>
<script src="{% static "js/plugins/datetimepicker/js/bootstrap-datetimepicker.min.js" %}" type="text/javascript"></script>
<script type="text/javascript">
    jQuery(document).ready(function($) {

        $('#id_model, #id_brand').select2({'width': '100%'});

        $('#id_status_description, #id_todo_description').redactor({
                lang: 'en',
                buttons: ['html', '|', 'formatting', '|', 'bold', 'italic', '|',
                            'unorderedlist', 'orderedlist', 'outdent', 'indent',
                            'alignment', 'horizontalrule', 'underline'],
        });

        $(function () {
            $('input#id_paid').iCheck({
              checkboxClass: 'icheckbox_square-blue',
              radioClass: 'iradio_square-blue',
              increaseArea: '20%' // optional
            });
        });

        $(function () {
            $('input[id^=id_addons_], input[id^=id_images_]').iCheck({
              checkboxClass: 'icheckbox_square-red',
              radioClass: 'iradio_square-red',
              increaseArea: '20%' // optional
            });
        });

        $(function(){
            $('#id_delivery_time').datetimepicker({
                useStrict: true,
                minDate:moment(),
                format: 'YYYY-MM-DD hh:mm:ss',
                widgetPositioning : {
                    horizontal: 'left',
                    vertical: 'bottom'
                },
                toolbarPlacement: 'top',

            });
        });



    function updateElementIndex(el, prefix, ndx) {
        var id_regex = new RegExp('(' + prefix + '-\\d+-)');
        var replacement = prefix + '-' + ndx + '-';
        if ($(el).attr("for")) $(el).attr("for", $(el).attr("for").replace(id_regex,
        replacement));
        if (el.id) el.id = el.id.replace(id_regex, replacement);
        if (el.name) el.name = el.name.replace(id_regex, replacement);
    }

    function deleteForm(btn, prefix) {
        var formCount = parseInt($('#id_' + prefix + '-TOTAL_FORMS').val());
        if (formCount > 1) {
            // Delete the item/form
            $(btn).parents('.'+prefix).remove();
            var forms = $('.'+prefix); // Get all the forms
            // Update the total number of forms (1 less than before)
            $('#id_' + prefix + '-TOTAL_FORMS').val(forms.length);
            var i = 0;
            // Go through the forms and set their indices, names and IDs
            for (formCount = forms.length; i < formCount; i++) {
                $(forms.get(i)).children().children().each(function () {
                    if ($(this).attr('type') == 'text') updateElementIndex(this, prefix, i);
                });
            }
        } // End if
        else {
            alert("You have to enter at least one item!");
        }
        return false;
    }

    function addForm(btn, prefix) {
        var formCount = parseInt($('#id_' + prefix + '-TOTAL_FORMS').val());
        // You can only submit a maximum of 10 items
        if (formCount < 10) {
            // Clone a form (without event handlers) from the first form
            // var row = $(".item:first").clone(false).get(0);
            var row = $(btn).parents('.box-body').find("."+prefix).clone(false).get(0);

            // Insert it after the last form
            // $(row).removeAttr('id').hide().insertAfter(".item:last").slideDown(300);
            row = $(row).clone().find(':input').each(function(){ $(this).val(''); }).end();

            $(row).removeAttr('id').hide().insertAfter('.'+prefix+':last').slideDown(300)


            // Remove the bits we don't want in the new row/form
            // e.g. error messages
            $(".errorlist", row).remove();
            $(row).children().removeClass("error");

            // Relabel or rename all the relevant bits
            $(row).children().children().each(function () {
                updateElementIndex(this, prefix, formCount);
                $(this).val("");
            });

            // Add an event handler for the delete item/form link
            $(row).find(".delete").click(function () {
                return deleteForm(this, prefix);
            });
            // Update the total form count
            $("#id_" + prefix + "-TOTAL_FORMS").val(formCount + 1);
        } // End if
        else {
            alert("Sorry, you can only enter a maximum of ten items.");
        }
        return false;
    }
    // Register the click event handlers
    $("#add-addon").click(function () {
        return addForm(this, "addons_phone");
    });

    $(".delete").click(function () {
        return deleteForm(this, "addons_phone");
    });

    $("#add-image").click(function () {
        return addForm(this, "images_phone");
    });

    $(".delete").click(function () {
        return deleteForm(this, "images_phone");
    });




    });
</script>
{% endblock %}
{% block extrastyle %}
<link rel="stylesheet" href="{% static "suit-redactor/redactor/redactor.css" %}">
<link href="{% static "js/plugins/iCheck/square/blue.css" %}" rel="stylesheet" type="text/css" />
<link href="{% static "js/plugins/iCheck/square/red.css" %}" rel="stylesheet" type="text/css" />
<link href="{% static "js/plugins/datetimepicker/css/bootstrap-datetimepicker.min.css" %}" rel="stylesheet" type="text/css" />
<link href="{% static "django_select2/css/select2.min.css" %}" rel="stylesheet" type="text/css" />
{% endblock %}